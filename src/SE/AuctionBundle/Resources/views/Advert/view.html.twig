{% extends "SELayoutBundle::layout.html.twig" %}

{% block title %}
    {{ advert.title }} - {{ parent() }}
{% endblock %}

{% block se_layout_body %}
    
    {% if app.session.flashBag.has('success') %}
        <div class="alert alert-success">
            {% for msg in app.session.flashBag.get('success') %}
                {{ msg }}
            {% endfor %}
        </div>
    {% endif %}
    
    <h3 class="cat-title">{{ advert.title }}</h3>
    <div class="col-md-12">
        <i>Par {{ advert.user }}, le {{ advert.dateCreation|date('d/m/Y') }}</i>
        <div class="row">
            <div class="col-md-6">
                <div class="thumbnail cadre">
                    <img style="width: 300px; height: 200px;" src="{{ asset(advert.category.webPath) }}" alt="{{ asset(advert.category.webPath) }}"> 
                </div>
            </div>
            <div class="col-lg-6">  
                <div class="panel">
                    
                    <div class="panel-body">
                      <p class="">
                         {% if is_granted("IS_AUTHENTICATED_REMEMBERED") %}
                            <button type="button" 
                                    class="btn btn-success" 
                                    data-toggle="modal" 
                                    data-target="#modalAuctionAdd">
                                    <i class="glyphicon glyphicon-euro" 
                                       
                                       ></i>
                                    Proposez un prix
                            </button>
                            
                            <button type="button" 
                                    class="btn btn-success" 
                                    data-toggle="modal" 
                                    data-target="#modalMessageAdd">
                                    <i class="glyphicon glyphicon-euro" ></i>
                                    Contacter
                            </button>
                         {% else %}
                             <button class="btn btn-success disabled"
                                    role="button" 
                                    >
                                 <i class="glyphicon glyphicon-euro" 
                                    
                                    ></i>Proposez un prix
                            </button>
                             
                             <button class="btn btn-warning disabled"
                                    role="button" 
                                    >
                                 <i class="glyphicon glyphicon-envelope" ></i>Contacter
                            </button>
                         {% endif %}
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-lg-6">  
                <div class="panel panel-default cadre">
                    <div class="panel-heading text-center">Détail de la demande</div>
                    <div class="panel-body">
                      <p>{{ advert.detail }}</p>
                    </div>
                </div>
            </div>
                    <div class="col-lg-6">
            <div class="panel panel-default cadre">
                    <div class="panel-heading text-center">Historique des Enchères</div>
                    <div class="panel-body">
                      <ul>
                        {% for auction in listAuctions %}
                            <li>
                                Enchère à {{ auction.value }} €,
                                le {{ auction.dateCreation|date('d/m/Y') }} à {{ auction.dateCreation|date('H:m:s') }},
                                par {{ auction.user }}
                            </li>
                        {% else %}
                            <li>Soyez le premier à proposer une enchère</li>
                        {% endfor %}
                        </ul>
                    </div>
                </div>
        </div>
        </div>
    </div>
                        
    {% if is_granted("IS_AUTHENTICATED_REMEMBERED") %}
        <div class="modal fade" 
             id="modalAuctionAdd" 
             tabindex="-1" 
             role="dialog" 
             aria-labelledby="modalAuctionAddLabel">
            {{ render(controller('SEAuctionBundle:Auction:add', {'request': app.request,'advertId':advert.id} )) }}
        </div>
        
        <div class="modal fade" 
             id="modalMessageAdd" 
             tabindex="-1" 
             role="dialog" 
             aria-labelledby="modalMessageAddLabel">
            {{ render(controller('SEAuctionBundle:Message:add', {'request': app.request,'advertId':advert.id} )) }}
        </div>
    {% endif %}

{% endblock %}